{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "VisualEditor55",
            "Effect": "Allow",
            "Action": [
                "application-autoscaling:*",
                "tag:*",
                "codestar:*",
                "cloudtrail:*",
                "autoscaling-plans:*",
                "autoscaling:*",
                "kms:*",
                "codedeploy:*",
                "events:*",
                "ec2:*",
                "iam:*",
                "rds:*",
                "ebs:*",
                "eks:*",
                "ec2-instance-connect:*",
                "appflow:*",
                "elasticfilesystem:*",
                "sns:*",
                "cloudshell:*",
                "s3:*",
                "cloudformation:*",
                "ecr-public:*",
                "codestar-connections:ListConnections",
                "codecommit:*",
                "ecs:*",
                "codepipeline:*",
                "ecr:*",
                "acm:*",
                "cloudwatch:*",
                "logs:*",
                "evidently:*",
                "rum:*",
                "applicationinsights:*",
                "synthetics:*",
                "glacier:*",
                "ses:*",
                "sqs:*",
                "xray:*",
                "elasticloadbalancing:*",
                "securityhub:*",
                "codeartifact:*",
                "sts:DecodeAuthorizationMessage"
            ],
            "Resource": "*",
            "Condition": {
                "StringEquals": {
                    "aws:RequestedRegion": [
                        "us-east-1"
                    ]
                }
            }
        },
        {
            "Sid": "VisualEditor56",
            "Effect": "Deny",
            "Action": "ebs:*",
            "Resource": "*",
            "Condition": {
                "NumericGreaterThanEquals": {
                    "ebs:VolumeSize": "31"
                }
            }
        },
        {
            "Sid": "VisualEditor57",
            "Effect": "Deny",
            "Action": "ec2:*",
            "Resource": "*",
            "Condition": {
                "ForAnyValue:NumericGreaterThanEquals": {
                    "ec2:VolumeSize": "31"
                }
            }
        },
        {
            "Sid": "VisualEditor58",
            "Effect": "Deny",
            "Action": "ec2:*",
            "Resource": "*",
            "Condition": {
                "ForAnyValue:StringNotEqualsIgnoreCase": {
                    "ec2:VolumeType": "gp2"
                }
            }
        },
        {
            "Sid": "VisualEditor59",
            "Effect": "Deny",
            "Action": [
                "ec2:PurchaseHostReservation",
                "ec2:GetHostReservationPurchasePreview",
                "ec2:DescribeHostReservationOfferings",
                "ec2:ModifySpotFleetRequest",
                "ec2:DescribeScheduledInstanceAvailability",
                "ec2:DescribeSpotDatafeedSubscription",
                "ec2:DescribeReservedInstances",
                "ec2:DescribeReservedInstancesListings",
                "ec2:PurchaseScheduledInstances",
                "ec2:CreateReservedInstancesListing",
                "ec2:DescribeCapacityReservations",
                "ec2:DescribeSpotFleetRequestHistory",
                "ec2:DescribeReservedInstancesOfferings",
                "ec2:CancelCapacityReservationFleets",
                "ec2:GetGroupsForCapacityReservation",
                "ec2:ModifyHosts",
                "ec2:GetReservedInstancesExchangeQuote",
                "eks:CreateFargateProfile",
                "ec2:CancelSpotInstanceRequests",
                "ec2:DescribeScheduledInstances",
                "ec2:GetSpotPlacementScores",
                "ec2:CancelCapacityReservation",
                "ec2:DescribeReservedInstancesModifications",
                "ec2:DeleteQueuedReservedInstances",
                "ec2:ModifyInstanceCapacityReservationAttributes",
                "ec2:DeleteSpotDatafeedSubscription",
                "ec2:DescribeCapacityReservationFleets",
                "ec2:PurchaseReservedInstancesOffering",
                "ec2:RequestSpotInstances",
                "ec2:RunScheduledInstances",
                "ec2:CancelSpotFleetRequests",
                "ec2:GetCapacityReservationUsage",
                "ec2:RequestSpotFleet",
                "ec2:DescribeSpotInstanceRequests",
                "ec2:ReleaseHosts",
                "ec2:DescribeSpotPriceHistory",
                "ec2:CreateCapacityReservationFleet",
                "ec2:CreateCapacityReservation",
                "ec2:CreateSpotDatafeedSubscription",
                "ec2:ModifyReservedInstances",
                "ec2:DescribeHostReservations",
                "ec2:SendSpotInstanceInterruptions",
                "ec2:ModifyCapacityReservationFleet",
                "eks:CreateNodegroup",
                "ec2:DescribeSpotFleetRequests",
                "ec2:DescribeHosts",
                "ec2:DescribeSpotFleetInstances",
                "ec2:ModifyCapacityReservation",
                "ec2:AcceptReservedInstancesExchangeQuote",
                "ec2:AllocateHosts",
                "ec2:CancelReservedInstancesListing"
            ],
            "Resource": "*"
        },
        {
            "Sid": "VisualEditor60",
            "Effect": "Deny",
            "Action": "rds:*",
            "Resource": "*",
            "Condition": {
                "StringNotLike": {
                    "rds:DatabaseClass": [
                        "*.micro",
                        "*.small",
                        "*.medium"
                    ]
                },
                "NumericGreaterThanEquals": {
                    "rds:StorageSize": "30",
                    "rds:Piops": "0"
                }
            }
        },
        {
            "Sid": "VisualEditor61",
            "Effect": "Deny",
            "Action": "ec2:*",
            "Resource": "arn:aws:ec2:*:*:instance/*",
            "Condition": {
                "ForAnyValue:StringNotLike": {
                    "ec2:InstanceType": [
                        "t1.micro",
                        "t2.nano",
                        "t2.micro",
                        "t2.small",
                        "t2.medium",
                        "t3.nano",
                        "t3.micro",
                        "t3.small",
                        "t3.medium"
                    ]
                }
            }
        }
    ]
}
